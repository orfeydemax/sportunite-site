---
name: figma-design
description: Скилл для взаимодействия с Figma. Позволяет читать структуру дизайна через REST API и генерировать скрипты для отрисовки дизайна через Plugin API.
---

# Навык Figma Design

Этот навык позволяет AntiGravity взаимодействовать с Figma двумя способами:
1.  **Чтение (Pull)**: Извлечение структуры дизайна, стилей и изображений из файла Figma с использованием REST API.
2.  **Запись (Push)**: Генерация JavaScript-кода, который создает элементы пользовательского интерфейса в Figma (через Plugin API).

## Предварительные требования

### 1. Персональный токен доступа Figma (Personal Access Token)
Для чтения данных из Figma необходим Personal Access Token.
1.  Перейдите в **Figma** -> **Settings** -> **Security** -> **Personal access tokens**.
2.  Нажмите **Generate token**.
3.  Скопируйте токен и сохраните его в надежном месте (например, в `.env` или предоставьте агенту по запросу).

### 2. Ключ файла (File Key) и ID узлов (Node IDs)
-   **File Key**: Находится в URL вашего файла: `figma.com/file/FILE_KEY/...`
-   **Node ID**: Выберите нужный элемент в Figma -> Правая кнопка мыши -> Copy Link (Копировать ссылку). Ссылка будет содержать параметр `?node-id=123-456`. Для использования в API замените дефис `-` на двоеточие `:` (например, `123:456`).

---

## 1. Чтение из Figma (Pull)

Используйте скрипт `scripts/figma_client.py` для извлечения данных о дизайне.

### Использование в агенте
Чтобы получить JSON-структуру конкретного фрейма или элемента (размеры, цвета, текст):

```python
python .agent/skills/figma-design/scripts/figma_client.py \
  --token "ВАШ_ТОКЕН" \
  --file_key "КЛЮЧ_ВАШЕГО_ФАЙЛА" \
  --node_ids "123:456" \
  --action get_nodes \
  --output "figma_structure.json"
```

Чтобы получить URL ссылок на изображения (PNG) для конкретных элементов:

```python
python .agent/skills/figma-design/scripts/figma_client.py \
  --token "ВАШ_ТОКЕН" \
  --file_key "КЛЮЧ_ВАШЕГО_ФАЙЛА" \
  --node_ids "123:456" \
  --action get_images
```

Выходной JSON будет содержать упрощенные данные узлов, которые можно использовать для генерации React-компонентов или CSS.

---

## 2. Запись в Figma (Push)

Используйте скрипт `scripts/figma_builder.py` для генерации скрипта, который "нарисует" созданный агентом интерфейс прямо в Figma.

### Рабочий процесс
1.  AntiGravity генерирует JSON-описание желаемого интерфейса (формат: список узлов).
2.  Запускается `figma_builder.py`, чтобы преобразовать этот JSON в фрагмент JavaScript кода для плагина Figma.
3.  Вы копируете полученный JS-код и запускаете его в Figma, используя плагин **Scripter** или консоль разработчика.

### Формат входного JSON
JSON должен описывать дерево элементов (визуальную структуру):

```json
{
  "type": "FRAME",
  "name": "Мой Компонент",
  "x": 0, "y": 0, "width": 200, "height": 100,
  "fills": [{"type": "SOLID", "color": {"r": 0.5, "g": 0.5, "b": 1}}],
  "children": [
    {
      "type": "TEXT",
      "x": 20, "y": 20,
      "characters": "Привет Figma"
    }
  ]
}
```

### Использование
```python
python .agent/skills/figma-design/scripts/figma_builder.py \
  --input "my_design.json" \
  --output "run_in_figma.js"
```

### Как запустить в Figma
1.  Откройте ваш файл Figma.
2.  Установите и откройте плагин **Scripter** (автор Rasmus Andersson) ИЛИ используйте встроенную консоль (Ctrl+Shift+I), если вы разрабатываете свой плагин. *Для быстрого запуска рекомендуется Scripter.*
3.  Вставьте содержимое файла `run_in_figma.js`.
4.  Нажмите Run (Запустить). Элементы появятся на текущей странице.

---

## Советы для "Пластилинового дизайна" (Claymorphism)
-   При **чтении** дизайна: обратите особое внимание на свойства **innerShadow (внутренние тени)** и **dropShadow (падающие тени)** в массиве `effects` выходного JSON. Именно они создают эффект объема и пластилина.
-   При **записи** в Figma: скрипт `figma_builder.py` можно расширить, добавив поддержку сложных эффектов теней, чтобы агент мог автоматически генерировать объемные "пластилиновые" кнопки и карточки.
